<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">Home | cealloga</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Simple microservices on demand"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="cealloga"><meta property="twitter:description" content="Simple microservices on demand"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/ancamcheachta/cealloga"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-compile">compile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parse">parse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-throwError">throwError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validate">validate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_cache">_cache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_idCache">_idCache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cache">cache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-compiler">compiler</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-messages">messages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-responses">responses</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-util">util</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isTest">isTest</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cealloga">cealloga</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-core">core</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dev">dev</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prod">prod</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#classes">classes</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/Ceallog.js~Ceallog.html">Ceallog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/CeallogError.js~CeallogError.html">CeallogError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/CompilerError.js~CompilerError.html">CompilerError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/HttpError.js~HttpError.html">HttpError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/ListError.js~ListError.html">ListError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/PublishError.js~PublishError.html">PublishError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/RecordError.js~RecordError.html">RecordError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/UnpublishError.js~UnpublishError.html">UnpublishError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/classes/ValidateError.js~ValidateError.html">ValidateError</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#code">code</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatter">formatter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-query">query</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findNew">findNew</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findOld">findOld</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-handleCompilerResult">handleCompilerResult</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-update">update</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findPublished">findPublished</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-update">update</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-handleBody">handleBody</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-handleCompilerResult">handleCompilerResult</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-save">save</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validateURIBlacklist">validateURIBlacklist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validateURIComponent">validateURIComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-messages">messages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-messages">messages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-messages">messages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-messages">messages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-messages">messages</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#plugins">plugins</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-UNPUBLISHED_CACHED_LIMIT">UNPUBLISHED_CACHED_LIMIT</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="cealloga">cealloga</h1><p><a href="https://travis-ci.org/ancamcheachta/cealloga"><img src="https://travis-ci.org/ancamcheachta/cealloga.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/r/ancamcheachta/cealloga"><img src="https://coveralls.io/repos/ancamcheachta/cealloga/badge.svg" alt="Coverage Status"></a>
<a href="https://badge.fury.io/js/cealloga"><img src="https://badge.fury.io/js/cealloga.svg" alt="npm version"></a>
<a href="https://doc.esdoc.org/github.com/ancamcheachta/cealloga"><img src="https://doc.esdoc.org/github.com/ancamcheachta/cealloga/badge.svg" alt="Documentation"></a>
<a href="https://snyk.io/test/github/ancamcheachta/cealloga"><img src="https://snyk.io/test/github/ancamcheachta/cealloga/badge.svg" alt="Vulnerabilities"></a></p>
<p>Ceall&#xF3;ga are simple ES6 arrow functions. Validate, test, and publish them as web
service endpoints, and do it all via an easy-to-use rest API.</p>
<h2 id="requirements">Requirements</h2><ul>
<li><a href="https://nodejs.org/en/download/">Node 6.11+</a></li>
<li><a href="https://docs.mongodb.com/manual/installation/">MongoDB 3.4+</a></li>
</ul>
<h2 id="install">Install</h2><p><code>npm install -g cealloga</code></p>
<h2 id="run">Run</h2><p><code>cealloga</code></p>
<h2 id="getting-started">Getting started</h2><p>In this tutorial, we&apos;ll create a microservice that:</p>
<ul>
<li>takes information from a raw data source called <code>colours</code></li>
<li>sums the colours up and returns them as an object called <code>chartData</code>;</li>
<li>something you might later consume in an UI component such as a bar chart, for</li>
<li>example.</li>
</ul>
<p>Before we begin, let&apos;s dissect the uncompressed source code we want to host as a
web service.</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">(ceallog) =&gt; {
    let colours = ceallog.vars.colours, // A list of colours, POSTed by the user in the request body.
        coloursMap = {}, // A map of colours, where key will be colour name (&apos;yellow&apos;) and value a total (`2`).
        chartData = {labels: [], series: []} // Chart data to build from incoming colours

    if (colours) { // Sum the colours...
        colours.forEach(c =&gt; coloursMap[c.name] = coloursMap[c.name] + 1 || 1);
    }

    for (var name in coloursMap) { // Push the `name` into labels and `total` into series in the same order.
        let total = coloursMap[name];

        chartData.labels.push(name);
        chartData.series.push(total);
    }

    return chartData;
}</code>
</code></pre>
<h3 id="validate">Validate</h3><p>We create our code by first posting it to the <code>/code/validate</code> service. When we
do this, the request is validated, the code is compiled, it&apos;s added to the
database and cached on the server, and finally we receive a response with some
information about it.</p>
<ol>
<li>Save the following file as <code>barchart.json</code>.<pre><code class="lang-json"><code class="source-code prettyprint">{
&quot;name&quot;:&quot;barchart&quot;,
&quot;label&quot;:&quot;Colour Total Bar Chart&quot;,
&quot;body&quot;:&quot;(ceallog)=&gt;{let colours=ceallog.vars.colours,coloursMap={},chartData={labels:[],series:[]};if(colours){colours.forEach(c=&gt;coloursMap[c.name]=coloursMap[c.name]+1||1)}for(var name in coloursMap){let total=coloursMap[name];chartData.labels.push(name);chartData.series.push(total)}return chartData;}&quot;
}</code>
</code></pre>
</li>
<li>In a terminal, run this curl command from the same directory as <code>barchart.json</code>:<pre><code class="lang-bash"><code class="source-code prettyprint">curl -H &quot;Content-Type: application/json&quot; -X POST -d @barchart.json http://localhost:8080/code/validate</code>
</code></pre>
</li>
</ol>
<p>You should now have a response like the following. Copy the <code>&quot;service&quot;</code> value;
you&apos;ll need it in the next example!</p>
<pre><code class="lang-json"><code class="source-code prettyprint">{
   &quot;compiled&quot;:true,
   &quot;id&quot;:&quot;5a610660158ffae3135b7c7e&quot;,
   &quot;created_date&quot;:&quot;2018-01-18T20:41:04.849Z&quot;,
   &quot;label&quot;:&quot;Colour Total Bar Chart&quot;,
   &quot;message&quot;:&quot;Resource retrieved successfully.&quot;,
   &quot;name&quot;:&quot;barchart&quot;,
   &quot;published&quot;:false,
   &quot;service&quot;:&quot;/cealloga/_test/5a610660158ffae3135b7c7e&quot;
}</code>
</code></pre>
<h3 id="test">Test</h3><p>Now that the code has been validated and created, let&apos;s send it some colour data
and test the results.</p>
<ol>
<li>Save the following file as <code>colours.json</code>.<pre><code class="lang-json"><code class="source-code prettyprint">{&quot;colours&quot;: [{&quot;name&quot;: &quot;blue&quot;}, {&quot;name&quot;: &quot;yellow&quot;}, {&quot;name&quot;: &quot;red&quot;}, {&quot;name&quot;: &quot;yellow&quot;}]}</code>
</code></pre>
</li>
<li>In a terminal, run this curl command from the same directory as <code>colours.json</code>:<pre><code class="lang-bash"><code class="source-code prettyprint">curl -H &quot;Content-Type: application/json&quot; -X POST -d @colours.json http://localhost:8080/cealloga/_test/5a610660158ffae3135b7c7e # &lt;- replace with your _test endpoint from the validate example</code>
</code></pre>
</li>
</ol>
<p>If you&apos;re seeing the following, it worked!</p>
<pre><code class="lang-json"><code class="source-code prettyprint">{
   &quot;labels&quot;:[
      &quot;blue&quot;,
      &quot;yellow&quot;,
      &quot;red&quot;
   ],
   &quot;series&quot;:[
      1,
      2,
      1
   ]
}</code>
</code></pre>
<h3 id="publish">Publish</h3><p>Once we&apos;re happy with the test results, we can publish the function by name as
<code>/cealloga/barchart</code>.</p>
<p>Run the following curl command.</p>
<pre><code class="lang-bash"><code class="source-code prettyprint">curl http://localhost:8080/code/publish/5a610660158ffae3135b7c7e # &lt;- replace with the id from the validate example</code>
</code></pre>
<p>You should get a response like the following:</p>
<pre><code class="lang-json"><code class="source-code prettyprint">{
   &quot;body&quot;:&quot;(ceallog)=&gt;{let colours=ceallog.vars.colours,coloursMap={},chartData={labels:[],series:[]};if(colours){colours.forEach(c=&gt;coloursMap[c.name]=coloursMap[c.name]+1||1)}for(var name in coloursMap){let total=coloursMap[name];chartData.labels.push(name);chartData.series.push(total)}return chartData;}&quot;,
   &quot;compiled&quot;:true,
   &quot;created_date&quot;:&quot;2018-01-18T20:41:04.849Z&quot;,
   &quot;id&quot;:&quot;5a610660158ffae3135b7c7e&quot;,
   &quot;label&quot;:&quot;Colour Total Bar Chart&quot;,
   &quot;name&quot;:&quot;barchart&quot;,
   &quot;published&quot;:true,
   &quot;service&quot;:&quot;/cealloga/barchart&quot;
}</code>
</code></pre>
<h3 id="making-a-request-to-the-published-endpoint">Making a request to the published endpoint</h3><p>The only thing left to day at this point is to check that <code>/cealloga/barchart</code>
is up and running.</p>
<p>In a terminal, run this curl command from the same directory as <code>colours.json</code>:</p>
<pre><code class="lang-bash"><code class="source-code prettyprint">curl -H &quot;Content-Type: application/json&quot; -X POST -d @colours.json http://localhost:8080/cealloga/barchart</code>
</code></pre>
<p>As in the test example above, if you&apos;re seeing the following, it worked again!</p>
<pre><code class="lang-json"><code class="source-code prettyprint">{
   &quot;labels&quot;:[
      &quot;blue&quot;,
      &quot;yellow&quot;,
      &quot;red&quot;
   ],
   &quot;series&quot;:[
      1,
      2,
      1
   ]
}</code>
</code></pre>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
