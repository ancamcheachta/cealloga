<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/classes/HttpError.js | cealloga</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Simple microservices on demand"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="cealloga"><meta property="twitter:description" content="Simple microservices on demand"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/ancamcheachta/cealloga"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/classes/HttpError.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

/**
 * @ignore
 */
const CompilerError = require(&apos;./CompilerError&apos;);

/**
 * @desc Normalised HTTP error class used prior to sending response.
 * @extends {Error}
 * @since 0.1.0
 */
class HttpError extends Error {
	/**
	 * @param {Error} inner Inner error specific to service (eg. 
	 * `ValidateError`).
	 * @param {string} errorType Type of error (eg. `&apos;NAME_NOT_ALLOWED&apos;`).
	 * @param {number} status Status code.
	 * @since 0.1.0
	 */
	constructor(inner, errorType, status) {
		super(inner.message);

		/**
		 * @type {string}
		 */
		this.name = this.constructor.name;
		/**
		 * @type {Error}
		 */
		this.inner = inner;

		/* istanbul ignore else */
		if (errorType &amp;&amp; status) {
			/**
			 * @type {string}
			 */
			this.errorType = errorType;
			/**
			 * @type {string}
			 */
			this.status = status;
		} else {
			this.serverError();
		}

		this.defineBody();
	}
	/**
	 * @desc Composes a body for the HTTP response to be sent.  If the inner
	 * error was a `CompilerError`, it adds additional `compiled` and `location`
	 * fields to the body.  In all cases, `error_type` and `message` are taken
	 * from the current `HttpError` instance.
	 * @since 0.1.0
	 */
	defineBody() {
		/**
		 * @type {Object}
		 */
		this.body = {};
		this.body.error_type = this.errorType;
		this.body.message = this.message;

		if (this.inner instanceof CompilerError) {
			this.body.compiled = false;
			this.body.location = this.inner.location;
		}
	}
	/**
	 * @desc Overrides class instance variables to reflect internal server
	 * error.
	 * @since 0.1.0
	 */
	/* istanbul ignore next */
	serverError() {
		this.errorType = &apos;INTERNAL_SERVER_ERROR&apos;;
		/**
		 * @type {string}
		 */
		this.message = &apos;An unknown exception occurred.&apos;;
		this.status = 500;
	}
	/**
	 * @desc Sets `res.statusCode` with current instance `status` and sends a
	 * json response with the current instance `body`.
	 * @param {Object} res Express response object.
	 */
	sendError(res) {
		res.statusCode = this.status;
		res.json(this.body);
	}
}

module.exports = HttpError;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
